import{a as U}from"./chunk-7VJC4XPP.js";import{a as Q}from"./chunk-QQ4YV3WZ.js";import{b as H,e as q,h as G,i as z,j as J,m as K}from"./chunk-HVWDDB5U.js";import"./chunk-E5YEAF2Z.js";import"./chunk-PIYG2HY2.js";import{e as V,g as A,h as B,i as R,j as W,n as $}from"./chunk-6Y6W3DZI.js";import{$a as w,Fa as D,Ka as p,R as x,Ta as d,Ua as e,Va as i,W as _,Wa as u,X as h,Y as b,Z as v,_a as S,ab as y,db as c,fb as f,i as F,jb as a,kb as g,l as I,lb as N,nb as E,ob as M,p as P,pb as L,q as T,ra as s,ub as O,vb as k,wb as C,x as j}from"./chunk-NRNLENJO.js";var Y=(n,l,t)=>({"text-green-600":n,"text-red-600":l,"text-yellow-600":t});function Z(n,l){if(n&1&&(e(0,"option",28),a(1),i()),n&2){let t=l.$implicit;d("value",t.id),s(),g(t.descripcion)}}function ee(n,l){n&1&&(e(0,"div",29),u(1,"div",30),e(2,"p",31),a(3,"Cargando subfamilias..."),i()())}function ie(n,l){if(n&1){let t=y();e(0,"div",32)(1,"div",33),b(),e(2,"svg",34),u(3,"path",35),i(),v(),e(4,"h3",36),a(5,"Error al cargar las subfamilias"),i()(),e(6,"div",37)(7,"p"),a(8),i(),e(9,"button",38),c("click",function(){_(t);let o=f();return h(o.listarSubfamilias())}),a(10," Reintentar "),i()()()}if(n&2){let t=f();s(8),g(t.errorMessage)}}function te(n,l){if(n&1){let t=y();S(0),e(1,"tr")(2,"td",51),a(3),i(),e(4,"td",52),a(5),i(),e(6,"td",53),a(7),i(),e(8,"td",54)(9,"span",55),a(10),i()(),e(11,"td",56)(12,"button",57),c("click",function(){let o=_(t).$implicit,m=f(3);return h(m.editarSubfamilia(o.id))}),a(13,"Editar"),i(),e(14,"button",58),c("click",function(){let o=_(t).$implicit,m=f(3);return h(m.eliminarSubfamilia(o.id))}),a(15,"Eliminar"),i()()(),w()}if(n&2){let t=l.$implicit;s(3),g(t.id),s(2),g(t.familia),s(2),g(t.descripcion),s(2),d("ngClass",O(5,Y,t.estado===1,t.estado===0,t.estado===2)),s(),N(" ",t.estado===1?"Activo":t.estado===0?"Inactivo":"Pendiente"," ")}}function ae(n,l){n&1&&(e(0,"tr")(1,"td",59),a(2,"No se encontraron subfamilias en el cat\xE1logo."),i()())}function ne(n,l){if(n&1&&(S(0),p(1,te,16,9,"ng-container",50),k(2,"async"),p(3,ae,3,0,"tr",46),w()),n&2){let t=l.ngIf,r=f(2);s(),d("ngForOf",C(2,2,r.subfamiliasData$)),s(2),d("ngIf",t.length===0)}}function re(n,l){if(n&1&&(e(0,"div",39)(1,"div",40)(2,"table",41)(3,"thead",42)(4,"tr")(5,"th",43),a(6,"ID"),i(),e(7,"th",43),a(8,"Familia"),i(),e(9,"th",43),a(10,"Descripci\xF3n"),i(),e(11,"th",43),a(12,"Estado"),i(),e(13,"th",44),a(14,"Acciones"),i()()(),e(15,"tbody",45),p(16,ne,4,4,"ng-container",46),k(17,"async"),i()()(),e(18,"div",47)(19,"span"),a(20,"Mostrando subfamilias registradas"),i(),e(21,"div")(22,"button",48),a(23,"Anterior"),i(),e(24,"button",49),a(25,"Siguiente"),i()()()()),n&2){let t=f();s(16),d("ngIf",C(17,1,t.subfamiliasData$))}}var X=class n{location;api;familiasApi;isLoading=!1;initialLoadDone=!1;errorMessage=null;subfamiliasSubject=new F([]);subfamiliasData$=this.subfamiliasSubject.asObservable();familias=[];filtroFamilia=0;filtroEstado=2;constructor(){this.location=x(V),this.api=x(U),this.familiasApi=x(Q)}ngOnInit(){this.listarFamilias(),this.listarSubfamilias()}listarSubfamilias(){this.errorMessage=null,this.isLoading=!0;let l={estado:this.filtroEstado,idfamilia:this.filtroFamilia};this.api.listaSubfamilias(l).pipe(P({each:7e3}),T(o=>o.exito?o.subFamilia:[]),j(o=>(this.errorMessage="No se pudo conectar al servidor. Revisa tu red o int\xE9ntalo m\xE1s tarde.",I([])))).subscribe({next:o=>{let m=[];Array.isArray(o)?m=o:o&&typeof o=="object"?m=[o]:m=[],this.subfamiliasSubject.next(m),this.initialLoadDone=!0},error:o=>{this.errorMessage=this.errorMessage??"No se pudo conectar al servidor."}}).add(()=>{this.isLoading=!1})}volverInicio(){this.location.back()}registrarSubfamilia(){}editarSubfamilia(l){}eliminarSubfamilia(l){confirm(`\xBFEst\xE1s seguro de eliminar la subfamilia con ID ${l}? Esto afectar\xE1 a sus productos asociados.`)}listarFamilias(){let l={estado:2};this.familiasApi.listaFamilias(l).subscribe({next:t=>{this.familias=t.exito?t.familia:[]},error:()=>{this.familias=[]}})}onFamiliaChange(){this.aplicarFiltros()}onEstadoChange(){this.aplicarFiltros()}aplicarFiltros(){this.listarSubfamilias()}limpiarFiltros(){this.filtroFamilia=0,this.filtroEstado=2,this.listarSubfamilias()}volverConfiguraciones(){this.location.back()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=D({type:n,selectors:[["app-listar-subfamilia-page"]],decls:36,vars:6,consts:[[1,"flex","flex-col","min-h-screen","bg-gray-50","p-4","sm:p-8"],[1,"flex","flex-col","md:flex-row","md:items-center","md:justify-between","pb-6","border-b","border-gray-300","flex-none"],[1,"flex","items-center","gap-4","mb-4","md:mb-0"],[1,"bg-orange-600","text-white","rounded-full","p-2","h-10","w-10","flex","items-center","justify-center","hover:bg-orange-700","transition",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-5","h-5"],["stroke","none","d","M0 0h24v24H0z","fill","none"],["d","M5 12l14 0"],["d","M5 12l4 4"],["d","M5 12l4 -4"],[1,"text-3xl","font-extrabold","text-gray-900"],[1,"w-full","md:w-auto","px-6","py-3","bg-orange-600","text-white","font-semibold","rounded-lg","shadow-md","hover:bg-orange-700","transition","duration-150","flex","items-center","justify-center",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-5","h-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"mt-6","flex","flex-col","lg:flex-row","gap-4","justify-between","items-center","bg-white","p-4","rounded-lg","shadow-md"],["type","text","placeholder","Buscar por nombre de subfamilia o ID...",1,"w-full","lg:w-1/4","px-4","py-2","border","border-gray-300","rounded-lg","focus:ring-orange-600","focus:border-orange-600","transition"],[1,"flex","flex-col","sm:flex-row","gap-3","w-full","lg:w-auto"],[1,"w-full","sm:w-48","px-4","py-2","border","border-gray-300","rounded-lg","focus:ring-orange-600","focus:border-orange-600","transition","bg-white",3,"ngModelChange","change","ngModel"],["value","0"],[3,"value",4,"ngFor","ngForOf"],[1,"w-full","sm:w-40","px-4","py-2","border","border-gray-300","rounded-lg","focus:ring-orange-600","focus:border-orange-600","transition","bg-white",3,"ngModelChange","change","ngModel"],["value","2"],["value","1"],[1,"w-full","sm:w-auto","px-4","py-2","bg-gray-500","text-white","rounded-lg","hover:bg-gray-600","transition","duration-150","flex","items-center","justify-center",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],["class","mt-8 flex justify-center items-center p-8",4,"ngIf"],["class","mt-8 bg-red-50 p-6 rounded-lg shadow-md",4,"ngIf"],["class","mt-8 flex-grow overflow-x-auto bg-white rounded-lg shadow-md",4,"ngIf"],[3,"value"],[1,"mt-8","flex","justify-center","items-center","p-8"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-orange-600"],[1,"ml-3","text-gray-600"],[1,"mt-8","bg-red-50","p-6","rounded-lg","shadow-md"],[1,"flex","items-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-6","h-6","text-red-600","mr-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-red-800","font-semibold"],[1,"mt-2"],[1,"mt-4","bg-red-600","text-white","px-4","py-2","rounded","hover:bg-red-700",3,"click"],[1,"mt-8","flex-grow","overflow-x-auto","bg-white","rounded-lg","shadow-md"],[1,"p-4"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-200"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-600","uppercase","tracking-wider"],[1,"px-6","py-3","text-right","text-xs","font-medium","text-gray-600","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[4,"ngIf"],[1,"p-4","border-t","border-gray-200","bg-gray-50","flex","justify-between","items-center","text-sm"],[1,"px-3","py-1","border","border-gray-300","rounded-l-lg","hover:bg-gray-100"],[1,"px-3","py-1","border","border-gray-300","rounded-r-lg","hover:bg-gray-100"],[4,"ngFor","ngForOf"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-orange-600","font-medium"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-semibold","text-gray-800"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium","text-gray-800"],[3,"ngClass"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"text-orange-600","hover:text-orange-800","mr-3",3,"click"],[1,"text-red-600","hover:text-red-800",3,"click"],["colspan","5",1,"px-6","py-4","text-center","text-gray-500"]],template:function(t,r){t&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),c("click",function(){return r.volverConfiguraciones()}),b(),e(4,"svg",4),u(5,"path",5)(6,"path",6)(7,"path",7)(8,"path",8),i()(),v(),e(9,"h1",9),a(10,"Subfamilias de Productos"),i()(),e(11,"button",10),c("click",function(){return r.registrarSubfamilia()}),b(),e(12,"svg",11),u(13,"path",12),i(),a(14," Nueva Subfamilia "),i()(),v(),e(15,"div",13),u(16,"input",14),e(17,"div",15)(18,"select",16),L("ngModelChange",function(m){return M(r.filtroFamilia,m)||(r.filtroFamilia=m),m}),c("change",function(){return r.onFamiliaChange()}),e(19,"option",17),a(20,"Todas las Familias"),i(),p(21,Z,2,2,"option",18),i(),e(22,"select",19),L("ngModelChange",function(m){return M(r.filtroEstado,m)||(r.filtroEstado=m),m}),c("change",function(){return r.onEstadoChange()}),e(23,"option",20),a(24,"Todos"),i(),e(25,"option",21),a(26,"Activos"),i(),e(27,"option",17),a(28,"Inactivos"),i()(),e(29,"button",22),c("click",function(){return r.limpiarFiltros()}),b(),e(30,"svg",23),u(31,"path",24),i(),a(32," Limpiar "),i()()(),p(33,ee,4,0,"div",25)(34,ie,11,1,"div",26)(35,re,26,3,"div",27),i()),t&2&&(s(18),E("ngModel",r.filtroFamilia),s(3),d("ngForOf",r.familias),s(),E("ngModel",r.filtroEstado),s(11),d("ngIf",r.isLoading),s(),d("ngIf",!r.isLoading&&r.errorMessage),s(),d("ngIf",!r.isLoading&&!r.errorMessage))},dependencies:[$,A,B,R,K,z,J,G,H,q,W],encapsulation:2})};export{X as ListarSubfamiliaPage};
